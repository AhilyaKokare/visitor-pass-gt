<div class="container mt-4">
  <h3>Security Dashboard - Today's Visitors</h3>

  <!-- Search Section (Unchanged) -->
  <div class="card mb-4">
    <div class="card-header fw-bold">Search for a Visitor Pass</div>
    <div class="card-body">
      <form (ngSubmit)="onSearch()">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Enter Visitor Pass Code..." name="passCode" [(ngModel)]="searchPassCode">
          <button class="btn btn-outline-primary" type="submit" [disabled]="!searchPassCode">
            <span *ngIf="isSearching" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
            {{ isSearching ? 'Searching...' : 'Search' }}
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Searched Pass Result (Unchanged, but with updated checkIn/checkOut) -->
  <div *ngIf="searchedPass" class="card bg-light mb-4">
    <!-- ... search result card content ... -->
  </div>

  <hr>

  <!-- VVV --- NEW PAGINATED TABLE --- VVV -->
  <h4>Today's Visitor Activity</h4>
  <div *ngIf="isLoading; else visitorTable">
    <app-loading-spinner></app-loading-spinner>
  </div>
  <ng-template #visitorTable>
    <div class="table-responsive">
      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th>#</th>
            <th>Visitor Name</th>
            <th>Pass Code</th>
            <th>Host Employee</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let pass of dashboardPage?.content; let i = index">
            <td>{{ (currentPage * pageSize) + i + 1 }}</td>
            <td>{{ pass.visitorName }}</td>
            <td>{{ pass.passCode }}</td>
            <td>{{ pass.createdByEmployeeName }}</td>
            <td>
              <span class="badge" [ngClass]="{
                'bg-primary': pass.status === 'APPROVED',
                'bg-info text-dark': pass.status === 'CHECKED_IN'
              }">{{ pass.status }}</span>
            </td>
            <td>
              <button *ngIf="pass.status === 'APPROVED'" class="btn btn-success btn-sm" (click)="checkIn(pass.id)">Check-In</button>
              <button *ngIf="pass.status === 'CHECKED_IN'" class="btn btn-warning btn-sm" (click)="checkOut(pass.id)">Check-Out</button>
            </td>
          </tr>
          <tr *ngIf="dashboardPage?.empty">
            <td colspan="6" class="text-center">No visitor activity for today.</td>
          </tr>
        </tbody>
      </table>
    </div>
    <app-pagination [page]="dashboardPage" (pageChange)="onPageChange($event)"></app-pagination>
  </ng-template>
</div>